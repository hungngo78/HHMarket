@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model HHMarketWebApp.Models.ShoppingCart

    @{
        var listItem = Model.listItemCart;
    }

    <style type="text/css"></style>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
    <link href="~/Content/shoppingCart.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="~/Content/hhstyle.css">

    <div class="container" style="margin-top: 50px;">
        <div>
            <h2 id="quantity"> Your cart:  @Model.listItemCart.Sum(item => item.Amount) items </h2>
            <table width="96%" style="margin: 20px;">
                @{  var i = -1;
                    foreach (var item in Model.listItemCart) {
                        i++;
                <tr>
                    <td width="70%" style="vertical-align:top">
                        <table cellspacing="10px">
                            <tr>
                                <td width="15%">
                                    <img src="https://i5.wal.co/asr/08072fb5-1a2d-473d-8060-863b07ccfa7b_2.c3429619370adb136931c9673eed592c.jpeg?odnHeight=100&amp;odnWidth=100&amp;odnBg=FFFFFF" alt="Mainstays Faux Leather Bucket Accent Chair" width="100">
                                </td>
                                <td width="50%" style="vertical-align:top">
                                    <span class="title-production" id="TitleProduction">
                                        @Html.DisplayFor(model => item.ProductName)
                                    </span>
                                    <span class="customer-info">Sold by HHMarket</span>
                                </td>

                                <td width="20%" style="vertical-align:top; padding-left:10px;">
                                    <span class="customer-info"> Qty:</span>
                                    <div id=@item.ProductDetailsId>
                
                                    </div>
                                </td>

                                <td style="text-align:right; padding-right: 10px;">
                                    <span class="customer-info" id="priceForEachID">
                                        $ @Html.DisplayFor(model => item.Price) ea
                                    </span>
                                    <span class="production-price" id="productionTotalPrice">$ @Html.DisplayFor(model => item.Price)</span>
                                    <span class="customer-info"><button class="btn">Remove</button></span>
                                </td>


                            </tr>
                            <tr>
                                <td colspan="4">
                                    <div style="width: 100%; height: 0.5px; background-color: lightgray; margin-top: 10px; margin-bottom:10px;"></div>
                                </td>

                            </tr>
                        </table>
                    </td>

                    <td style="width:30%; vertical-align:top; ">
                        @if (i == 0)
                        {
                        <table width="89%" cellspacing="10" style="background-color: #F5F5F5;  padding-right: 10px;">
                            <tr>
                                <td style="text-align:left">
                                    Subtotal( @Model.listItemCart.Sum(model => item.Amount) items)
                                </td>

                                <td style="text-align:right">
                                    $397.00
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align:left">
                                    <span>Shipping</span>
                                </td>

                                <td style="text-align:right">
                                    <span> free </span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <div style="width: 100%; height: 0.5px; background-color: lightgray; margin-top: 10px; margin-bottom:10px;"></div>
                                </td>

                            </tr>
                            <tr>
                                <td style="text-align:left">
                                    <span>Estimated Total</span>
                                </td>

                                <td style="text-align:right">
                                    <span> $431.74 </span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="text-align:center">
                                    <button class="btn">Check out</button>

                                </td>
                            </tr>

                        </table>
                        }
                    </td>
                </tr>
                        }
                    }

            </table>
        </div>
    </div>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript">
        var shoppingCart;
        $(document).ready(function () {
            shoppingCart = @Html.Raw(Json.Encode(Model.listItemCart));
            setupQuantityUI();

        });

        function updateTotalPricePro(prodItem) {

            var productionTotalPrice = document.getElementById("productionTotalPrice");
            //get quantity
            var productionTotalPrice = document.getElementById(prodItem.ProductDetailsId).querySelector('select').text;
           // if (productionTotalPrice != "+10")
                productionTotalPrice.innerHTML = prodItem.Price * productionTotalPrice;
        }
       function setupQuantityUI() {
         

           
           if (shoppingCart != null && shoppingCart != "undefined") {
               // var quantitySelect = document.getElementById(shoppingCart[i].ProductDetailsId);
               
              // var quantitySelect = document.getElementById("quantityUI");
               // quantitySelect.innerHTML = " ";
               for (var i = 0; i < shoppingCart.length; i++) {
                   alert("shoppingCart[i].ProductDetailsId " + shoppingCart[i].ProductDetailsId);
                   var quantitySelect = document.createElement("select");
                   quantitySelect.style = "width:60px;"

                   var option = document.createElement("option");
                   var quantityUI = document.getElementById(""+shoppingCart.ProductDetailsId);
                   quantitySelect.id = "quantity_" + shoppingCart.ProductDetailsId;
                   alert("shoppingCart[i].TotalAmountProduction " + shoppingCart[i].TotalAmountProduction);
                   if (shoppingCart[i].TotalAmountProduction > 10) {
                       for (var j = 1; j <= 10; j++) {
                           option.text = "" + j;
                           quantitySelect.appendChild(option);
                       }
                       option.text = "10+";
                       quantitySelect.add(option);

                   } else {
                       for (var k = 1; k <= shoppingCart[i].TotalAmountProduction; k++) {
                           option.text = "" + k;
                           option.value = "" + k;
                           quantitySelect.appendChild(option);
                           alert(" k = " + k);
                       }
                   }
                   //  quantitySelect.selectedIndex = shoppingCart[i].Amount;
                   alert("quantityUI " + quantityUI);
                   quantityUI.innerHTML = quantitySelect;
                   alert(" shoppingCart[i].Amount = " + shoppingCart[i].Amount);
                   // add totalPrice each Production
                   updateTotalPricePro(shoppingCart[i])
               }
              
           }
       }
    </script>

