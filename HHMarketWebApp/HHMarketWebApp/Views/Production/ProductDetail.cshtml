@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model HHMarketWebApp.Models.ProductionDetail

@{ var displayItem = Model.listdata.ElementAt(0);
    var arrData = Model.listdata;
    var listItem = Model.listdata;
}

<style type="text/css">
</style>
<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="~/Content/hhstyle.css">
<link rel="stylesheet" type="text/css" href="~/Content/productDetail.css">
<div class="container" style="margin-top: 50px;">
    <div>
        <p style="color:blue; padding-bottom: 10px;">Smartphone > Samsung > Galaxy S</p>
        <table style="width:100%">
            <tr>
                <td style="width:40%">
                    <div>
                        <table>
                            <tr>
                                <td>
                                    <table id="imgTable"></table>
                                </td>
                                <td>
                                    <img id="largeImageId" align="middle" class="productdetail_image_large" src="">
                                </td>
                            </tr>
                        </table>
                        <div class="btn_addtocart" align="center">
                            <button class="Add-to-Cart">Add to Cart</button>
                        </div>
                    </div>
                </td>
                <td class="product_detail_right">
                    <div>
                        <table>
                            <tr>
                                <p> @Html.DisplayFor(model => displayItem.ProductionName)</p>
                            </tr>
                            <tr>
                                <td style="padding-right:10px;">by</td>
                                <td style="color:blue;"> Samsung</td>
                            </tr>
                            <tr>
                                <td style="padding-top: 10px;">
                                    <table>
                                        <tr>
                                            <td> <img src="~/assets/common_img/Star.png" /></td>
                                            <td> <img src="~/assets/common_img/Star.png" /></td>
                                            <td> <img src="~/assets/common_img/Star.png" /></td>
                                            <td> <img src="~/assets/common_img/Star.png" /></td>
                                            <td> <img src="~/assets/common_img/Star.png" /></td>
                                        </tr>
                                    </table>

                                </td>
                                <td style="color:blue; padding-top: 10px; padding-left: 10px;">
                                    48 customer reviews
                                </td>
                            </tr>

                            <tr>
                                <td style="color: blue; padding-top:10px;">
                                    Price:
                                </td>
                                <td style="color:red; padding-top:10px;" id="priceID">
                                    @Html.DisplayFor(model => displayItem.Price)$
                                </td>

                                <td class="orignal_price" style="padding-top:10px; padding-left:10px; padding-right: 10px;"> <strike>500.0$</strike></td>

                                <td style="color:black; padding-top:10px;">
                                    FREE Shipping
                                </td>
                            </tr>
                            <tr>
                                <td style="color: gray; padding-top:10px;">
                                    Color:
                                </td>
                                <td style="padding-top:10px;">

                                    <select name="color" id="colorID">
                                        @foreach (var itemPro in Model.listdata.GroupBy(item => item.Color))
                                        {
                                            <option onclick="changeColor(this)" value=@itemPro.Key>@itemPro.Key</option>
                                        }
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td style="color: gray; padding-top:10px;">
                                    Size:
                                </td>
                                <td style="padding-top:10px;">

                                    <select name="size" id="sizeID" size="3">
                                        @foreach (var itemPro in Model.listdata.GroupBy(item => item.Size))
                                        {
                                            <option onclick="changeSize(this)" value=@itemPro.Key>@itemPro.Key</option>
                                        }
                                    </select>
                                </td>
                            </tr>

                        </table>
                        <p style="padding:10px;" id="descriptionID">
                            @Html.DisplayFor(model => displayItem.Description)
                        </p>
                    </div>
                </td>
            <tr>
        </table>

    </div>
    <div id="footer" class="footer stable">

        <div>
            <span>
                ©
                <script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/api2/v1537770717608/recaptcha__en_gb.js"></script>
                <script type="text/javascript">document.write(new Date().getFullYear());</script>
            </span>&nbsp;
            <span data-token="copyRightPhraseDJ">HHMarket Inc. All rights reserved.</span>
        </div>
    </div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript">
        var modelPro;
        $(document).ready(function () {


    @{  var serializer = new System.Web.Script.Serialization.JavaScriptSerializer();
      //  var json = serializer.Serialize(Model.listdata);


    }

        modelPro = @Html.Raw(Json.Encode(listItem));
        if (modelPro != null && modelPro != "undefined") {
            setUpImageTable(modelPro[0]);
        }

    });


        function setUpImageTable(modelPro) {
            var imageList = modelPro.Picture.split(',');
         
            var table = document.getElementById("imgTable");
            table.innerHTML = ' ';
            for (var r = 0; r < imageList.length; r++) {
                if (r == 0) {
                    var largeImage = document.getElementById("largeImageId");
                    largeImage.src = '/assets/production/' + modelPro.ProductId + '/' + modelPro.Color + '/' + imageList[r];
                }

                var row = table.insertRow(r);
                row.setAttribute("class", "productdetail_image_rectangle");
                row.setAttribute("align", "center");
                row.insertCell(0).innerHTML = '<img align="middle" class="productdetail_image" src="/assets/production/' + modelPro.ProductId + '/' + modelPro.Color + '/' + imageList[r] + '">';
            }
    }
    function changeSize(ob) {

    }
    function displaySize(color) {
        var sizeList = document.getElementById("sizeID").options;
        var chooseItem = false;
        for (var i = 0; i < modelPro.length; i++) {

            if (color == modelPro[i].Color) {
          
                for (var s = 0; s < sizeList.length; s++) {
                    if (sizeList.item(s).text == modelPro[i].Size) {
                        sizeList.item(s).setAttribute("background-color", "black");
                        if (chooseItem == false) {
                            document.getElementById("sizeID").selectedIndex = s;
                            chooseItem = true;
                        }
                    } else {
                        sizeList.item(s).setAttribute("background-color", "gray");
                    }
                }
                
            }

            if (chooseItem == false) {
                document.getElementById("sizeID").selectedIndex = -1;
            }

        }


    }
    function changeColor(ob) {
        var color = ob.value;
        displaySize(color);
        var size = $("#sizeID option:selected").val();
            if (modelPro != null && modelPro != "undefined")
                for (var i = 0; i < modelPro.length; i++) {
                    if (color == modelPro[i].Color && size == modelPro[i].Size) {
                    document.getElementById("priceID").innerText = modelPro[i].Price + "$";
                    setUpImageTable(modelPro[i]);
                    document.getElementById("descriptionID").innerText = modelPro[i].Description;
                    break;
                }
            }
    }

</script>


